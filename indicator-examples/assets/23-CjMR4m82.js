import{n as p,q as _,g as S,R as m,h as f}from"./sample-data-RBJYs_3z.js";import{c as D}from"./weighted-close-calculation-BeWUi6qC.js";function b(s,e){class a{_baseSeries=null;_indicatorSeries=null;_chart=null;_options=null;attached(t){const{chart:n,series:h}=t;this._chart=n,this._baseSeries=h,this._indicatorSeries=this._chart.addSeries(p),this._options=e,h.subscribeDataChanged(this._updateData),this._updateData()}detached(){this._baseSeries&&this._baseSeries.unsubscribeDataChanged(this._updateData),this._indicatorSeries&&this._chart?.removeSeries(this._indicatorSeries),this._indicatorSeries=null}indicatorSeries(){if(!this._indicatorSeries)throw new Error("unable to provide indicator series");return this._indicatorSeries}applyOptions(t){this._options={...this._options||{},...t},this._updateData()}_updateData=()=>{if(!this._indicatorSeries)return;if(!this._baseSeries){this._indicatorSeries.setData([]);return}const t=this._baseSeries.data(),n=D(t,this._options||e);this._indicatorSeries.setData(n)}}const c=new a;return s.attachPrimitive(c),c}const g={autoSize:!0},l=_("chart",g),d=S(150,new Date(2024,0,1)),[w,v]=[d.slice(0,100),d.slice(100)],i=document.getElementById("weight");let r=2;i instanceof HTMLInputElement&&(r=Number.parseInt(i.value,10));const o=l.addSeries(m,{});o.setData(w);const u=b(o,{offset:2});u.indicatorSeries().applyOptions({color:"orange",lineWidth:2,lineStyle:f.Dotted});i instanceof HTMLInputElement&&i.addEventListener("input",()=>{r=Number.parseInt(i.value,10),u.applyOptions({weight:r})});l.timeScale().fitContent();setTimeout(async()=>{function s(e){return new Promise(a=>{setTimeout(a,e)})}for(const e of v)o.update(e),await s(200)},2e3);
