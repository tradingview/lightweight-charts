"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["42835"],{31154:function(e,n,t){t.r(n),t.d(n,{default:()=>m,frontMatter:()=>c,metadata:()=>i,assets:()=>l,toc:()=>h,contentTitle:()=>o});var i=JSON.parse('{"id":"plugins/series-primitives","title":"Series Primitives","description":"Primitives are extensions to the series which can define views and renderers to","source":"@site/versioned_docs/version-5.0/plugins/series-primitives.mdx","sourceDirName":"plugins","slug":"/plugins/series-primitives","permalink":"/lightweight-charts/docs/plugins/series-primitives","draft":false,"unlisted":false,"tags":[],"version":"5.0","sidebarPosition":1,"frontMatter":{"sidebar_label":"Series Primitives","sidebar_position":1},"sidebar":"docsSidebar","previous":{"title":"Introduction","permalink":"/lightweight-charts/docs/plugins/intro"},"next":{"title":"Pane Primitives","permalink":"/lightweight-charts/docs/plugins/pane-primitives"}}'),r=t("85893"),a=t("50065"),s=t("30353");let c={sidebar_label:"Series Primitives",sidebar_position:1},o="Series Primitives",l={},h=[{value:"Views",id:"views",level:2},{value:"IPrimitivePaneView",id:"iprimitivepaneview",level:3},{value:"Interactive Demo of zOrder layers",id:"interactive-demo-of-zorder-layers",level:4},{value:"ISeriesPrimitiveAxisView",id:"iseriesprimitiveaxisview",level:3},{value:"Lifecycle Methods",id:"lifecycle-methods",level:2},{value:"attached",id:"attached",level:3},{value:"detached",id:"detached",level:3},{value:"Updating Views",id:"updating-views",level:2},{value:"Extending the Autoscale Info",id:"extending-the-autoscale-info",level:2}];function d(e){let n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",ul:"ul",...(0,a.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"series-primitives",children:"Series Primitives"})}),"\n",(0,r.jsxs)(n.p,{children:["Primitives are extensions to the series which can define views and renderers to\ndraw on the chart using\n",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D",children:"CanvasRenderingContext2D"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Primitives are defined by implementing the\n",(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/type-aliases/ISeriesPrimitive",children:(0,r.jsx)(n.code,{children:"ISeriesPrimitive"})})," interface. The\ninterface defines the basic functionality and structure required for creating\ncustom primitives."]}),"\n",(0,r.jsx)(n.h2,{id:"views",children:"Views"}),"\n",(0,r.jsx)(n.p,{children:"The primary purpose of a series primitive is to provide one, or more, views to\nthe library which contain the state and logic required to draw on the chart\npanes."}),"\n",(0,r.jsxs)(n.p,{children:["There are two types of views which are supported within ",(0,r.jsx)(n.code,{children:"ISeriesPrimitive"})," which\nare:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/IPrimitivePaneView",children:(0,r.jsx)(n.code,{children:"IPrimitivePaneView"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/ISeriesPrimitiveAxisView",children:(0,r.jsx)(n.code,{children:"ISeriesPrimitiveAxisView"})})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The library will evoke the following getter functions (if defined) to get\nreferences to the primitive's defined views for the corresponding section of the\nchart:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/ISeriesPrimitiveBase#paneviews",children:(0,r.jsx)(n.code,{children:"paneViews"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/ISeriesPrimitiveBase#priceaxispaneviews",children:(0,r.jsx)(n.code,{children:"priceAxisPaneViews"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/ISeriesPrimitiveBase#timeaxispaneviews",children:(0,r.jsx)(n.code,{children:"timeAxisPaneViews"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/ISeriesPrimitiveBase#priceaxisviews",children:(0,r.jsx)(n.code,{children:"priceAxisViews"})})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/ISeriesPrimitiveBase#timeaxisviews",children:(0,r.jsx)(n.code,{children:"timeAxisViews"})})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["The first three views allow drawing on the corresponding panes (main chart pane,\nprice scale pane, and horizontal time scale pane) using the\n",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D",children:"CanvasRenderingContext2D"}),"\nand should implement the ",(0,r.jsx)(n.code,{children:"ISeriesPrimitivePaneView"})," interface."]}),"\n",(0,r.jsxs)(n.p,{children:["The views returned by the ",(0,r.jsx)(n.code,{children:"priceAxisViews"})," and ",(0,r.jsx)(n.code,{children:"timeAxisViews"})," getter methods\nshould implement the ",(0,r.jsx)(n.code,{children:"ISeriesPrimitiveAxisView"})," interface and are used to define\nlabels to be drawn on the corresponding scales."]}),"\n",(0,r.jsx)(n.p,{children:"Below is a visual example showing the various sections of the chart where a\nPrimitive can draw."}),"\n","\n",(0,r.jsx)(s.ZP,{replaceThemeConstants:!0,chart:!0,className:"language-js",chartOnly:!0,children:"/* eslint-disable max-classes-per-file */\nclass AxisView {\n	constructor(text, color, position) {\n		this._color = color;\n		this._text = text;\n		this._position = position;\n	}\n	coordinate() {\n		return this._position;\n	}\n	text() {\n		return this._text;\n	}\n	textColor() {\n		return '#FFFFFF';\n	}\n	backColor() {\n		return this._color;\n	}\n}\n\nclass LegendPaneRenderer {\n	constructor(sections) {\n		this._sections = Object.values(sections);\n	}\n	draw(target) {\n		const count = this._sections.length;\n		const longestText = this._sections.reduce((longest, section) => {\n			if (section.name.length > longest.length) {\n				return section.name;\n			}\n			return longest;\n		}, '');\n		target.useMediaCoordinateSpace(scope => {\n			const ctx = scope.context;\n			const longestTextMeasurements = ctx.measureText(longestText);\n			ctx.beginPath();\n			ctx.roundRect(\n				20,\n				20,\n				longestTextMeasurements.width + 40,\n				(count + 0) * 20 + 10,\n				8\n			);\n			ctx.globalAlpha = 0.95;\n			ctx.fillStyle = '#FFFFFF';\n			ctx.fill();\n			ctx.globalAlpha = 1;\n			let currentY = 30;\n			this._sections.forEach(section => {\n				ctx.beginPath();\n				ctx.roundRect(30, currentY, 10, 10, 3);\n				ctx.fillStyle = section.color;\n				ctx.fill();\n				ctx.fillStyle = '#000000';\n				ctx.textBaseline = 'bottom';\n				ctx.fillText(section.name, 50, currentY + 10);\n				currentY += 20;\n			});\n		});\n	}\n}\n\nclass LegendView {\n	constructor(sections) {\n		this._renderer = new LegendPaneRenderer(sections);\n	}\n	zOrder() {\n		return 'top';\n	}\n	renderer() {\n		return this._renderer;\n	}\n}\n\nclass PaneRenderer {\n	constructor(color) {\n		this._color = color;\n	}\n	draw(target) {\n		target.useMediaCoordinateSpace(scope => {\n			const ctx = scope.context;\n			ctx.beginPath();\n			ctx.rect(0, 0, scope.mediaSize.width, scope.mediaSize.height);\n			ctx.globalAlpha = 0.3;\n			ctx.fillStyle = this._color;\n			ctx.fill();\n			ctx.globalAlpha = 0.6;\n			ctx.lineWidth = 8;\n			ctx.strokeStyle = this._color;\n			ctx.stroke();\n			ctx.globalAlpha = 1;\n		});\n	}\n}\n\nclass PaneView {\n	constructor(color) {\n		this._renderer = new PaneRenderer(color);\n	}\n	zOrder() {\n		return 'bottom';\n	}\n	renderer() {\n		return this._renderer;\n	}\n}\n\nclass SectionsPrimitive {\n	constructor() {\n		this.sections = {\n			pane: { color: '#4cc9f0', name: 'Chart Pane (paneViews)' },\n			price: { color: '#f72585', name: 'Price Pane (priceAxisPaneViews)' },\n			time: { color: '#4361ee', name: 'Time Pane (timeAxisPaneViews)' },\n			priceLabel: { color: '#f77f00', name: 'Price Label (priceAxisViews)' },\n			timeLabel: { color: '#40916c', name: 'Time Label (timeAxisViews)' },\n		};\n		this._paneViews = [\n			new PaneView(this.sections.pane.color),\n			new LegendView(this.sections),\n		];\n		this._pricePaneViews = [new PaneView(this.sections.price.color)];\n		this._timePaneViews = [new PaneView(this.sections.time.color)];\n		this._priceAxisViews = [\n			new AxisView('price label', this.sections.priceLabel.color, 80),\n		];\n		this._timeAxisViews = [\n			new AxisView('time label', this.sections.timeLabel.color, 200),\n		];\n	}\n\n	updateAllViews() {}\n\n	paneViews() {\n		return this._paneViews;\n	}\n\n	timeAxisPaneViews() {\n		return this._timePaneViews;\n	}\n\n	priceAxisPaneViews() {\n		return this._pricePaneViews;\n	}\n\n	timeAxisViews() {\n		return this._timeAxisViews;\n	}\n\n	priceAxisViews() {\n		return this._priceAxisViews;\n	}\n}\n\nlet randomFactor = 25 + Math.random() * 25;\nconst samplePoint = i =>\n	i *\n		(0.5 +\n			Math.sin(i / 10) * 0.2 +\n			Math.sin(i / 20) * 0.4 +\n			Math.sin(i / randomFactor) * 0.8 +\n			Math.sin(i / 500) * 0.5) +\n	200;\n\nfunction generateLineData(numberOfPoints = 500) {\n	randomFactor = 25 + Math.random() * 25;\n	const res = [];\n	const date = new Date(Date.UTC(2018, 0, 1, 12, 0, 0, 0));\n	for (let i = 0; i < numberOfPoints; ++i) {\n		const time = date.getTime() / 1000;\n		const value = samplePoint(i);\n		res.push({\n			time,\n			value,\n			customValues: {\n				text: 'hello',\n			},\n		});\n\n		date.setUTCDate(date.getUTCDate() + 1);\n	}\n\n	return res;\n}\n\nconst chartOptions = {\n	layout: {\n		textColor: CHART_TEXT_COLOR,\n		background: { type: 'solid', color: CHART_BACKGROUND_COLOR },\n	},\n};\n\nconst chart = createChart(document.getElementById('container'), chartOptions);\n\nconst lineSeries = chart.addSeries(LineSeries, {\n	color: CHART_TEXT_COLOR,\n});\nconst data = generateLineData();\nlineSeries.setData(data);\nlineSeries.attachPrimitive(new SectionsPrimitive());\n"}),"\n",(0,r.jsx)(n.h3,{id:"iprimitivepaneview",children:"IPrimitivePaneView"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/IPrimitivePaneView",children:(0,r.jsx)(n.code,{children:"IPrimitivePaneView"})}),"\ninterface can be used to define a view which provides a renderer (implementing\nthe\n",(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/IPrimitivePaneRenderer",children:(0,r.jsx)(n.code,{children:"IPrimitivePaneRenderer"})}),"\ninterface) for drawing on the corresponding area of the chart using the\n",(0,r.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D",children:"CanvasRenderingContext2D"}),"\nAPI. The view can define a\n",(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/IPrimitivePaneView#zorder",children:(0,r.jsx)(n.code,{children:"zOrder"})})," to control where\nin the visual stack the drawing will occur (See\n",(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/type-aliases/PrimitivePaneViewZOrder",children:(0,r.jsx)(n.code,{children:"PrimitivePaneViewZOrder"})}),"\nfor more information)."]}),"\n",(0,r.jsxs)(n.p,{children:["Renderers should provide a\n",(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/IPrimitivePaneRenderer#draw",children:(0,r.jsx)(n.code,{children:"draw"})})," method which will\nbe given a ",(0,r.jsx)(n.code,{children:"CanvasRenderingTarget2D"})," target on which it can draw. Additionally,\na renderer can optionally provide a\n",(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/IPrimitivePaneRenderer#drawbackground",children:(0,r.jsx)(n.code,{children:"drawBackground"})}),"\nmethod for drawing beneath other elements on the same zOrder."]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"CanvasRenderingTarget2D"})," is explained in more detail on the ",(0,r.jsx)(n.a,{href:"./canvas-rendering-target",children:"Canvas Rendering Target"})," page."]})}),"\n",(0,r.jsx)(n.h4,{id:"interactive-demo-of-zorder-layers",children:"Interactive Demo of zOrder layers"}),"\n",(0,r.jsx)(n.p,{children:"Below is an interactive demo chart illustrating where each zOrder is drawn\nrelative to the existing chart elements such as the grid, series, and crosshair."}),"\n","\n",(0,r.jsx)(s.ZP,{replaceThemeConstants:!0,chart:!0,className:"language-js",chartOnly:!0,children:"class PaneRenderer {\n	constructor(layer, showName, index, numBands) {\n		this._layer = layer;\n		this._showName = showName;\n		this._index = index;\n		this._selected = 'all';\n		this._numBands = numBands;\n	}\n	draw(target) {\n		if (this._layer.background) {\n			return;\n		}\n		if (this._selected !== 'all' && this._selected !== this._layer.id) {\n			return;\n		}\n		this._drawImpl(target);\n	}\n	drawBackground(target) {\n		if (!this._layer.background) {\n			return;\n		}\n		if (this._selected !== 'all' && this._selected !== this._layer.id) {\n			return;\n		}\n		this._drawImpl(target);\n	}\n\n	_drawingAngle(scope) {\n		const isPriceScale = scope.mediaSize.width < 100;\n		const isTimeScale = scope.mediaSize.height < 50;\n		if (isPriceScale) {\n			return 0;\n		}\n		if (isTimeScale) {\n			return Math.PI / 2;\n		}\n		return Math.PI / 3;\n	}\n\n	_drawImpl(target) {\n		target.useMediaCoordinateSpace(scope => {\n			const ctx = scope.context;\n			ctx.save();\n			if (this._selected === 'all') {\n				const isScale = scope.mediaSize.height < 50 || scope.mediaSize.width < 100;\n				const numBands = this._numBands + (isScale ? 2 : 0);\n				const angle = this._drawingAngle(scope);\n				const shift = Math.cos(angle) * scope.mediaSize.height;\n				const bandWidth = Math.round(\n					(scope.mediaSize.width - shift) / numBands\n				);\n				const offset = isScale ? 2 : 0;\n				const startX = (this._index + (isScale ? 1 : 0)) * bandWidth;\n				ctx.beginPath();\n				ctx.moveTo(startX, scope.mediaSize.height);\n				ctx.lineTo(startX + shift, offset);\n				ctx.lineTo(startX + shift + bandWidth, offset);\n				ctx.lineTo(startX + bandWidth, scope.mediaSize.height);\n				ctx.closePath();\n				ctx.fillStyle = this._layer.color;\n				ctx.fill();\n				if (this._showName) {\n					ctx.fillStyle = this._layer.textColor;\n					ctx.font = 'normal 16px sans-serif';\n					ctx.translate(startX, scope.mediaSize.height);\n					ctx.rotate(-1.06 * angle);\n					ctx.fillText(this._layer.name, 20, 20);\n				}\n			} else {\n				ctx.beginPath();\n				ctx.rect(0, 0, scope.mediaSize.width, scope.mediaSize.height);\n				ctx.fillStyle = this._layer.color;\n				ctx.fill();\n			}\n			ctx.restore();\n		});\n	}\n	update(name) {\n		this._selected = name;\n	}\n}\n\nclass PaneView {\n	constructor(layer, showName, index, numBands) {\n		this._layer = layer;\n		this._renderer = new PaneRenderer(layer, showName, index, numBands);\n	}\n	zOrder() {\n		return this._layer.zOrder;\n	}\n	renderer() {\n		return this._renderer;\n	}\n	update(name) {\n		this._renderer.update(name);\n	}\n}\n\nclass LayersPrimitive {\n	constructor() {\n		this.layers = {\n			bottom: {\n				name: 'bottom',\n				color: '#f72585',\n				textColor: '#ffffff',\n				zOrder: 'bottom',\n				background: false,\n				id: 'bottom',\n			},\n			normalBackground: {\n				name: 'normal (background)',\n				color: '#7209b7',\n				textColor: '#ffffff',\n				zOrder: 'normal',\n				background: true,\n				id: 'normalBackground',\n			},\n			normal: {\n				name: 'normal',\n				color: '#4361ee',\n				textColor: '#ffffff',\n				zOrder: 'normal',\n				background: false,\n				id: 'normal',\n			},\n			top: {\n				name: 'top',\n				color: '#4cc9f0',\n				textColor: '#000000',\n				zOrder: 'top',\n				background: false,\n				id: 'top',\n			},\n		};\n		const layerKeys = ['bottom', 'normalBackground', 'normal', 'top'];\n		const numBands = layerKeys.length;\n		this._paneViews = layerKeys.map(\n			(key, index) => new PaneView(this.layers[key], true, index, numBands)\n		);\n		this._pricePaneViews = layerKeys.map(\n			(key, index) => new PaneView(this.layers[key], false, index, numBands)\n		);\n		this._timePaneViews = layerKeys.map(\n			(key, index) => new PaneView(this.layers[key], false, index, numBands)\n		);\n	}\n\n	changeSelectedLayer(id) {\n		if (id !== 'all' && !Object.keys(this.layers).includes(id)) {\n			return;\n		}\n		this._paneViews.forEach(view => view.update(id));\n		this._pricePaneViews.forEach(view => view.update(id));\n		this._timePaneViews.forEach(view => view.update(id));\n		if (this._requestUpdate) {\n			this._requestUpdate();\n		}\n	}\n\n	attached({ requestUpdate }) {\n		this._requestUpdate = requestUpdate;\n	}\n	detached() {\n		this._requestUpdate = undefined;\n	}\n\n	updateAllViews() {}\n\n	paneViews() {\n		return this._paneViews;\n	}\n\n	timeAxisPaneViews() {\n		return this._timePaneViews;\n	}\n\n	priceAxisPaneViews() {\n		return this._pricePaneViews;\n	}\n}\n\nlet randomFactor = 25 + Math.random() * 25;\nconst samplePoint = i =>\n	i *\n		(0.5 +\n			Math.sin(i / 10) * 0.2 +\n			Math.sin(i / 20) * 0.4 +\n			Math.sin(i / randomFactor) * 0.8 +\n			Math.sin(i / 500) * 0.5) +\n	200;\n\nfunction generateLineData(numberOfPoints = 500) {\n	randomFactor = 25 + Math.random() * 25;\n	const res = [];\n	const date = new Date(Date.UTC(2018, 0, 1, 12, 0, 0, 0));\n	for (let i = 0; i < numberOfPoints; ++i) {\n		const time = date.getTime() / 1000;\n		const value = samplePoint(i);\n		res.push({\n			time,\n			value,\n			customValues: {\n				text: 'hello',\n			},\n		});\n\n		date.setUTCDate(date.getUTCDate() + 1);\n	}\n\n	return res;\n}\n\nconst chartOptions = {\n	layout: {\n		textColor: CHART_TEXT_COLOR,\n		background: { type: 'solid', color: CHART_BACKGROUND_COLOR },\n	},\n};\n\nconst chart = createChart(document.getElementById('container'), chartOptions);\n\nconst lineSeries = chart.addSeries(LineSeries, {\n	color: CHART_TEXT_COLOR,\n});\nconst data = generateLineData();\nlineSeries.setData(data);\nconst layersPrimitive = new LayersPrimitive();\nlineSeries.attachPrimitive(layersPrimitive);\n\nfunction generateLayerOption(id, name, selected) {\n	const element = document.createElement('option');\n	element.value = id;\n	element.innerHTML = name;\n	element.selected = selected;\n	return element;\n}\n\nconst chartContainer = document.querySelector('#container');\nif (chartContainer) {\n	const layerSelect = document.createElement('select');\n	layerSelect.id = 'layer-select';\n	layerSelect.name = 'layer';\n	chartContainer.parentElement.appendChild(layerSelect);\n	layerSelect.style.position = 'absolute';\n	layerSelect.style.zIndex = 10;\n	layerSelect.style.left = '10px';\n	layerSelect.style.top = '10px';\n}\n\nconst layerSelectDiv = document.querySelector('#layer-select');\n// eslint-disable-next-line no-console\nconsole.log(layerSelectDiv);\nif (layerSelectDiv) {\n	layerSelectDiv.appendChild(generateLayerOption('all', 'All', true));\n	for (const layerInfo of Object.values(layersPrimitive.layers)) {\n		layerSelectDiv.appendChild(\n			generateLayerOption(layerInfo.id, layerInfo.name, false)\n		);\n	}\n	layerSelectDiv.addEventListener('change', () => {\n		layersPrimitive.changeSelectedLayer(layerSelectDiv.value);\n	});\n}\n"}),"\n",(0,r.jsx)(n.h3,{id:"iseriesprimitiveaxisview",children:"ISeriesPrimitiveAxisView"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/ISeriesPrimitiveAxisView",children:(0,r.jsx)(n.code,{children:"ISeriesPrimitiveAxisView"})}),"\ninterface can be used to define a label on the price or time axis."]}),"\n",(0,r.jsxs)(n.p,{children:["This interface provides several methods to define the appearance and position of\nthe label, such as the\n",(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/ISeriesPrimitiveAxisView#coordinate",children:(0,r.jsx)(n.code,{children:"coordinate"})})," method,\nwhich should return the desired coordinate for the label on the axis. It also\ndefines optional methods to set the fixed coordinate, text, text color,\nbackground color, and visibility of the label."]}),"\n",(0,r.jsxs)(n.p,{children:["Please see the\n",(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/ISeriesPrimitiveAxisView",children:(0,r.jsx)(n.code,{children:"ISeriesPrimitiveAxisView"})}),"\ninterface for more details."]}),"\n",(0,r.jsx)(n.h2,{id:"lifecycle-methods",children:"Lifecycle Methods"}),"\n",(0,r.jsxs)(n.p,{children:["Your primitive can use the\n",(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/ISeriesPrimitiveBase#attached",children:(0,r.jsx)(n.code,{children:"attached"})})," and\n",(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/ISeriesPrimitiveBase#detached",children:(0,r.jsx)(n.code,{children:"detached"})})," lifecycle methods to\nmanage the lifecycle of the primitive, such as creating or removing external\nobjects and event handlers."]}),"\n",(0,r.jsx)(n.h3,{id:"attached",children:"attached"}),"\n",(0,r.jsxs)(n.p,{children:["This method is called when the primitive is attached to a chart. The attached\nmethod is evoked with a\n",(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/SeriesAttachedParameter",children:"single argument"})," containing\nproperties for the chart, series, and a callback to request an update. The\n",(0,r.jsx)(n.code,{children:"chart"})," and ",(0,r.jsx)(n.code,{children:"series"})," properties are references to the chart API and the series\nAPI instances for convenience purposes so that they don't need to be manually\nprovided within the primitive's constructor (if needed by the primitive)."]}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"requestUpdate"})," callback allows the primitive to notify the chart that it\nshould be updated and redrawn."]}),"\n",(0,r.jsx)(n.h3,{id:"detached",children:"detached"}),"\n",(0,r.jsx)(n.p,{children:"This method is called when the primitive is detached from a chart. This can be\nused to remove any external objects or event handlers that were created during\nthe attached lifecycle method."}),"\n",(0,r.jsx)(n.h2,{id:"updating-views",children:"Updating Views"}),"\n",(0,r.jsxs)(n.p,{children:["Your primitive should update the views in the\n",(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/ISeriesPrimitiveBase#updateallviews",children:(0,r.jsx)(n.code,{children:"updateAllViews()"})})," method\nsuch that when the renderers are evoked, they can draw with the latest\ninformation. The library invokes this method when it wants to update and redraw\nthe chart. If you would like to notify the library that it should trigger an\nupdate then you can use the ",(0,r.jsx)(n.code,{children:"requestUpdate"})," callback provided by the attached\nlifecycle method."]}),"\n",(0,r.jsx)(n.h2,{id:"extending-the-autoscale-info",children:"Extending the Autoscale Info"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.a,{href:"/lightweight-charts/docs/api/interfaces/ISeriesPrimitiveBase#autoscaleinfo",children:(0,r.jsx)(n.code,{children:"autoscaleInfo()"})}),"\nmethod can be provided to extend the base autoScale information of the series.\nThis can be used to ensure that the chart is automatically scaled correctly to\ninclude all the graphics drawn by the primitive."]}),"\n",(0,r.jsx)(n.p,{children:"Whenever the chart needs to calculate the vertical visible range of the series\nwithin the current time range then it will evoke this method. This method can be\nomitted and the library will use the normal autoscale information for the\nseries. If the method is implemented then the returned values will be merged\nwith the base autoscale information to define the vertical visible range."}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsx)(n.p,{children:"Please note that this method will be evoked very often during\nscrolling and zooming of the chart, thus it is recommended that this method is\neither simple to execute, or makes use of optimisations such as caching to\nensure that the chart remains responsive."})})]})}function m(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},30353:function(e,n,t){t.d(n,{ZP:()=>w});var i=t("85893"),r=t("67294"),a=t("31705"),s=t("44634"),c=t("79207"),o=t("57378"),l=t("64926"),h=t("6646");function d(e,n,t){e.addEventListener("resize",()=>{let e=n.getBoundingClientRect();t(e.width,e.height)},!0)}let m={3.8:async e=>{let n=await t.e("70967").then(t.bind(t,51083));return{module:n,createChart:(t,i)=>{let r=n.createChart(t,i);return d(e,t,r.resize.bind(r)),r},createChartEx:void 0,createYieldCurveChart:void 0,createOptionsChart:void 0}},"4.0":async e=>{let n=await t.e("98966").then(t.bind(t,11413));return{module:n,createChart:(t,i)=>{let r=n.createChart(t,i);return d(e,t,r.resize.bind(r)),r},createChartEx:void 0,createYieldCurveChart:void 0,createOptionsChart:void 0}},4.1:async e=>{let n=await t.e("85998").then(t.bind(t,1860));return{module:n,createChart:(t,i)=>{let r=n.createChart(t,i);return d(e,t,r.resize.bind(r)),r},createChartEx:(t,i,r)=>{let a=n.createChartEx(t,i,r);return d(e,t,a.resize.bind(a)),a},createYieldCurveChart:void 0,createOptionsChart:void 0}},4.2:async e=>{let n=await t.e("15373").then(t.bind(t,15757));return{module:n,createChart:(t,i)=>{let r=n.createChart(t,i);return d(e,t,r.resize.bind(r)),r},createChartEx:(t,i,r)=>{let a=n.createChartEx(t,i,r);return d(e,t,a.resize.bind(a)),a},createYieldCurveChart:void 0,createOptionsChart:void 0}},"5.0":async e=>{let n=await t.e("11191").then(t.bind(t,96473));return{module:n,createChart:(t,i)=>{let r=n.createChart(t,i);return d(e,t,r.resize.bind(r)),r},createChartEx:(t,i,r)=>{let a=n.createChartEx(t,i,r);return d(e,t,a.resize.bind(a)),a},createYieldCurveChart:(t,i)=>{let r=n.createYieldCurveChart(t,i);return d(e,t,r.resize.bind(r)),r},createOptionsChart:(t,i)=>{let r=n.createOptionsChart(t,i);return d(e,t,r.resize.bind(r)),r}}},current:async()=>{let e=await t.e("22433").then(t.bind(t,3768));return{module:e,createChart:(n,t)=>{let i=e.createChart(n,t);return d(window,n,i.resize.bind(i)),i},createChartEx:(n,t,i)=>{let r=e.createChartEx(n,t,i);return d(window,n,r.resize.bind(r)),r},createYieldCurveChart:(n,t)=>{let i=e.createYieldCurveChart(n,t);return d(window,n,i.resize.bind(i)),i},createOptionsChart:(n,t)=>{let i=e.createOptionsChart(n,t);return d(window,n,i.resize.bind(i)),i}}}},p={iframe:"iframe_R_Fr"};function u(e){let{script:n,iframeStyle:t}=e,{preferredVersion:a}=(0,o.J)(),s=h&&h.length>0?h["0"]:"",c=a?.name??s??"current",d=`
		<style>
			html,
			body,
			#container {
				width: 100%;
				height: 100%;
				overflow: hidden;
				margin: 0;
			}
		</style>
		<div id="container"></div>
		<script>
			window.run = () => {
				${n}
			};
		</script>
	`,u=r.useRef(null),x="current"===c||parseInt(c.split(".")[0])>=5;return(r.useEffect(()=>{let e=u.current,n=e?.contentWindow,t=e?.contentDocument;if(null===e||!n||!t||!x)return;let i=async()=>{try{let{module:e,createChart:t,createChartEx:i,createYieldCurveChart:r,createOptionsChart:a}=await m[c](n);Object.assign(n,e),n.createChart=t,n.createChartEx=i,n.createYieldCurveChart=r,n.createOptionsChart=a,n.LineSeries=e.LineSeries,n.AreaSeries=e.AreaSeries,n.CandlestickSeries=e.CandlestickSeries,n.BarSeries=e.BarSeries,n.HistogramSeries=e.HistogramSeries,n.run?.()}catch(e){console.error(e)}};if(void 0!==n.run)i();else{let n=()=>{i(),e.removeEventListener("load",n)};e.addEventListener("load",n)}},[d]),x)?(0,i.jsx)("iframe",{ref:u,srcDoc:d,className:p.iframe,style:t},n):(0,i.jsx)("div",{children:(0,i.jsx)(l.Z,{type:"caution",title:"Chart visualization is not available for this version",children:(0,i.jsx)("p",{children:"Switch to a version 5 or higher to see the chart"})})})}var x=t("98159");let g=()=>`${Math.random().toString(36).slice(2,11)}`,f=Object.keys(x.l.DARK),w=e=>{let{chart:n,replaceThemeConstants:t,hideableCode:o,chartOnly:l,chartOnTop:h=!1,iframeStyle:d,replaceTabs:m=!0,codeUsage:w,...v}=e,{children:_}=e,{colorMode:O}=(0,c.I)(),C=function(){let[e,n]=(0,r.useState)("");return(0,r.useEffect)(()=>n(g()),[]),e}();if(t&&"string"==typeof _&&(_=function(e,n){let t=n?x.l.DARK:x.l.LIGHT,i=e;for(let e of f)i=i.replace(RegExp(e,"g"),`'${t[e]}'`);return i}(_,"dark"===O)),m&&"string"==typeof _&&(_=_.replace(/\t/g,"    ")),_=_.replace(RegExp(/\/\/ delete-start[\w\W]*?\/\/ delete-end/,"gm"),""),n||o){let e=!l&&(0,i.jsx)(a.Z,{...v,children:_}),t=n&&(0,i.jsx)(s.Z,{fallback:(0,i.jsx)("div",{className:p.iframe,children:"\xa0"}),children:()=>(0,i.jsx)(u,{script:_,iframeStyle:d})}),r=o&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{id:C,type:"checkbox",className:"toggle-hidden-lines"}),(0,i.jsx)("label",{className:"toggle-label",htmlFor:C,children:"Show all code"})]});return h?(0,i.jsxs)(i.Fragment,{children:[t,w,r,e]}):(0,i.jsxs)(i.Fragment,{children:[w,r,e,t]})}return(0,i.jsx)(a.Z,{...v,children:_})}},98159:function(e,n,t){t.d(n,{l:function(){return i}});let i={DARK:{CHART_BACKGROUND_COLOR:"black",CHART_BACKGROUND_RGB_COLOR:"0, 0, 0",LINE_LINE_COLOR:"#2962FF",LINE_LINE2_COLOR:"rgb(225, 87, 90)",LINE_LINE3_COLOR:"rgb(242, 142, 44)",LINE_LINE4_COLOR:"rgb(164, 89, 209)",LINE_LINE5_COLOR:"rgb(27, 156, 133)",AREA_TOP_COLOR:"#2962FF",AREA_BOTTOM_COLOR:"rgba(41, 98, 255, 0.28)",BAR_UP_COLOR:"#26a69a",BAR_DOWN_COLOR:"#ef5350",BASELINE_TOP_LINE_COLOR:"rgba( 38, 166, 154, 1)",BASELINE_TOP_FILL_COLOR1:"rgba( 38, 166, 154, 0.28)",BASELINE_TOP_FILL_COLOR2:"rgba( 38, 166, 154, 0.05)",BASELINE_BOTTOM_LINE_COLOR:"rgba( 239, 83, 80, 1)",BASELINE_BOTTOM_FILL_COLOR1:"rgba( 239, 83, 80, 0.05)",BASELINE_BOTTOM_FILL_COLOR2:"rgba( 239, 83, 80, 0.28)",HISTOGRAM_COLOR:"#26a69a",CHART_TEXT_COLOR:"white"},LIGHT:{CHART_BACKGROUND_COLOR:"white",CHART_BACKGROUND_RGB_COLOR:"255, 255, 255",LINE_LINE_COLOR:"#2962FF",LINE_LINE2_COLOR:"rgb(225, 87, 90)",LINE_LINE3_COLOR:"rgb(242, 142, 44)",LINE_LINE4_COLOR:"rgb(164, 89, 209)",LINE_LINE5_COLOR:"rgb(27, 156, 133)",AREA_TOP_COLOR:"#2962FF",AREA_BOTTOM_COLOR:"rgba(41, 98, 255, 0.28)",BAR_UP_COLOR:"#26a69a",BAR_DOWN_COLOR:"#ef5350",BASELINE_TOP_LINE_COLOR:"rgba( 38, 166, 154, 1)",BASELINE_TOP_FILL_COLOR1:"rgba( 38, 166, 154, 0.28)",BASELINE_TOP_FILL_COLOR2:"rgba( 38, 166, 154, 0.05)",BASELINE_BOTTOM_LINE_COLOR:"rgba( 239, 83, 80, 1)",BASELINE_BOTTOM_FILL_COLOR1:"rgba( 239, 83, 80, 0.05)",BASELINE_BOTTOM_FILL_COLOR2:"rgba( 239, 83, 80, 0.28)",HISTOGRAM_COLOR:"#26a69a",CHART_TEXT_COLOR:"black"}}},6646:function(e){e.exports=JSON.parse('["5.0","4.2","4.1","4.0","3.8"]')}}]);